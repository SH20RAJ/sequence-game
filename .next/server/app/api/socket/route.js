/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/socket/route";
exports.ids = ["app/api/socket/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?32c4":
/*!****************************!*\
  !*** bufferutil (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsocket%2Froute&page=%2Fapi%2Fsocket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsocket%2Froute.ts&appDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsocket%2Froute&page=%2Fapi%2Fsocket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsocket%2Froute.ts&appDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_shaswatraj_Desktop_open_source_sequence_src_app_api_socket_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/socket/route.ts */ \"(rsc)/./src/app/api/socket/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/socket/route\",\n        pathname: \"/api/socket\",\n        filename: \"route\",\n        bundlePath: \"app/api/socket/route\"\n    },\n    resolvedPagePath: \"/Users/shaswatraj/Desktop/open-source/sequence/src/app/api/socket/route.ts\",\n    nextConfigOutput,\n    userland: _Users_shaswatraj_Desktop_open_source_sequence_src_app_api_socket_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/socket/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzb2NrZXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnNvY2tldCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnNvY2tldCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNoYXN3YXRyYWolMkZEZXNrdG9wJTJGb3Blbi1zb3VyY2UlMkZzZXF1ZW5jZSUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZzaGFzd2F0cmFqJTJGRGVza3RvcCUyRm9wZW4tc291cmNlJTJGc2VxdWVuY2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzBCO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VxdWVuY2UtZ2FtZS8/ZjQzNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvc2hhc3dhdHJhai9EZXNrdG9wL29wZW4tc291cmNlL3NlcXVlbmNlL3NyYy9hcHAvYXBpL3NvY2tldC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc29ja2V0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc29ja2V0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zb2NrZXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvc2hhc3dhdHJhai9EZXNrdG9wL29wZW4tc291cmNlL3NlcXVlbmNlL3NyYy9hcHAvYXBpL3NvY2tldC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvc29ja2V0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsocket%2Froute&page=%2Fapi%2Fsocket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsocket%2Froute.ts&appDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/socket/route.ts":
/*!*************************************!*\
  !*** ./src/app/api/socket/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var socket_io__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io */ \"(rsc)/./node_modules/socket.io/wrapper.mjs\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _utils_game__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/game */ \"(rsc)/./src/utils/game.ts\");\n\n\n\n// Socket.io server instance\nlet io;\n// Store active games in memory\nconst activeGames = new Map();\n// Socket.io server initialization function\nconst initSocketServer = ()=>{\n    if (!io) {\n        io = new socket_io__WEBPACK_IMPORTED_MODULE_0__.Server({\n            path: \"/api/socket\",\n            addTrailingSlash: false,\n            cors: {\n                origin: \"*\",\n                methods: [\n                    \"GET\",\n                    \"POST\"\n                ]\n            }\n        });\n        io.on(\"connection\", (socket)=>{\n            console.log(\"Client connected:\", socket.id);\n            // Join a room\n            socket.on(\"joinRoom\", async ({ roomCode })=>{\n                try {\n                    socket.join(roomCode);\n                    // Get game data from database\n                    const game = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].game.findUnique({\n                        where: {\n                            roomCode\n                        },\n                        include: {\n                            host: true,\n                            playerToGame: {\n                                include: {\n                                    player: true\n                                }\n                            },\n                            gameState: true\n                        }\n                    });\n                    if (!game) {\n                        socket.emit(\"error\", {\n                            message: \"Room not found\"\n                        });\n                        return;\n                    }\n                    // Format players data\n                    const players = game.playerToGame.map((ptg)=>({\n                            id: ptg.player.id,\n                            name: ptg.player.name,\n                            isHost: ptg.player.id === game.hostId,\n                            hand: []\n                        }));\n                    // Get or initialize game state\n                    let gameState = null;\n                    if (game.gameState) {\n                        gameState = {\n                            status: game.status,\n                            board: game.gameState.board,\n                            currentTurn: game.gameState.currentTurn,\n                            player1: {\n                                id: players[0]?.id,\n                                sequences: game.gameState.sequences.filter((s)=>s.player === \"player1\")\n                            },\n                            player2: {\n                                id: players[1]?.id,\n                                sequences: game.gameState.sequences.filter((s)=>s.player === \"player2\")\n                            },\n                            winner: game.gameState.winner\n                        };\n                        // If game is in progress, get player hands\n                        if (game.status === \"playing\") {\n                            const player1Hand = game.gameState.player1Hand;\n                            const player2Hand = game.gameState.player2Hand;\n                            // Find the current player\n                            const currentPlayerIndex = players.findIndex((p)=>p.id === socket.id);\n                            if (currentPlayerIndex === 0) {\n                                players[0].hand = player1Hand;\n                            } else if (currentPlayerIndex === 1) {\n                                players[1].hand = player2Hand;\n                            }\n                        }\n                    }\n                    // Send room data to the client\n                    socket.emit(\"roomData\", {\n                        players,\n                        gameState,\n                        currentPlayer: players.find((p)=>p.id === socket.id)\n                    });\n                    // Notify other clients in the room\n                    socket.to(roomCode).emit(\"playerJoined\", {\n                        players\n                    });\n                } catch (error) {\n                    console.error(\"Error joining room:\", error);\n                    socket.emit(\"error\", {\n                        message: \"Failed to join room\"\n                    });\n                }\n            });\n            // Start the game\n            socket.on(\"startGame\", async ({ roomCode })=>{\n                try {\n                    // Get game data from database\n                    const game = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].game.findUnique({\n                        where: {\n                            roomCode\n                        },\n                        include: {\n                            playerToGame: {\n                                include: {\n                                    player: true\n                                }\n                            }\n                        }\n                    });\n                    if (!game) {\n                        socket.emit(\"error\", {\n                            message: \"Room not found\"\n                        });\n                        return;\n                    }\n                    if (game.hostId !== socket.id) {\n                        socket.emit(\"error\", {\n                            message: \"Only the host can start the game\"\n                        });\n                        return;\n                    }\n                    if (game.playerToGame.length < 2) {\n                        socket.emit(\"error\", {\n                            message: \"Need at least 2 players to start\"\n                        });\n                        return;\n                    }\n                    if (game.status !== \"waiting\") {\n                        socket.emit(\"error\", {\n                            message: \"Game has already started\"\n                        });\n                        return;\n                    }\n                    // Initialize the game\n                    const deck = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.createDeck)();\n                    const shuffledDeck = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.shuffleDeck)(deck);\n                    const { hands, remainingDeck } = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.dealCards)(shuffledDeck, 2);\n                    const board = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.createGameBoard)();\n                    // Create game state\n                    const gameState = {\n                        status: \"playing\",\n                        board,\n                        currentTurn: game.playerToGame[0].playerId,\n                        player1: {\n                            id: game.playerToGame[0].playerId,\n                            sequences: []\n                        },\n                        player2: {\n                            id: game.playerToGame[1].playerId,\n                            sequences: []\n                        }\n                    };\n                    // Save game state to database\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].gameState.create({\n                        data: {\n                            gameId: game.id,\n                            currentTurn: gameState.currentTurn,\n                            board: gameState.board,\n                            deck: remainingDeck,\n                            player1Hand: hands[0],\n                            player2Hand: hands[1],\n                            sequences: []\n                        }\n                    });\n                    // Update game status\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].game.update({\n                        where: {\n                            id: game.id\n                        },\n                        data: {\n                            status: \"playing\"\n                        }\n                    });\n                    // Store game state in memory\n                    activeGames.set(roomCode, {\n                        gameState,\n                        deck: remainingDeck,\n                        hands\n                    });\n                    // Send game state to all clients in the room\n                    io.to(roomCode).emit(\"gameStarted\", {\n                        gameState,\n                        players: game.playerToGame.map((ptg, index)=>({\n                                id: ptg.player.id,\n                                name: ptg.player.name,\n                                isHost: ptg.player.id === game.hostId,\n                                hand: hands[index]\n                            }))\n                    });\n                } catch (error) {\n                    console.error(\"Error starting game:\", error);\n                    socket.emit(\"error\", {\n                        message: \"Failed to start game\"\n                    });\n                }\n            });\n            // Play a card\n            socket.on(\"playCard\", async ({ roomCode, card, position })=>{\n                try {\n                    // Get active game from memory\n                    const activeGame = activeGames.get(roomCode);\n                    if (!activeGame) {\n                        socket.emit(\"error\", {\n                            message: \"Game not found\"\n                        });\n                        return;\n                    }\n                    const { gameState, deck, hands } = activeGame;\n                    if (gameState.status !== \"playing\") {\n                        socket.emit(\"error\", {\n                            message: \"Game is not in progress\"\n                        });\n                        return;\n                    }\n                    if (gameState.currentTurn !== socket.id) {\n                        socket.emit(\"error\", {\n                            message: \"Not your turn\"\n                        });\n                        return;\n                    }\n                    // Determine player index (0 or 1)\n                    const playerIndex = gameState.player1.id === socket.id ? 0 : 1;\n                    const playerKey = playerIndex === 0 ? \"player1\" : \"player2\";\n                    const opponentKey = playerIndex === 0 ? \"player2\" : \"player1\";\n                    // Check if player has the card\n                    const handIndex = hands[playerIndex].findIndex((c)=>c.id === card.id);\n                    if (handIndex === -1) {\n                        socket.emit(\"error\", {\n                            message: \"Card not in hand\"\n                        });\n                        return;\n                    }\n                    // Handle card play based on type\n                    if (card.isJack) {\n                        if (card.jackType === \"one-eyed\") {\n                            // One-eyed Jack: Remove opponent's chip\n                            if (!position) {\n                                socket.emit(\"error\", {\n                                    message: \"Position required for one-eyed Jack\"\n                                });\n                                return;\n                            }\n                            const { row, col } = position;\n                            const cell = gameState.board[row][col];\n                            if (!cell.chip || cell.chip === playerKey) {\n                                socket.emit(\"error\", {\n                                    message: \"Can only remove opponent's chips\"\n                                });\n                                return;\n                            }\n                            // Remove the chip\n                            gameState.board[row][col].chip = undefined;\n                        } else {\n                            // Two-eyed Jack: Place chip anywhere\n                            if (!position) {\n                                socket.emit(\"error\", {\n                                    message: \"Position required for two-eyed Jack\"\n                                });\n                                return;\n                            }\n                            const { row, col } = position;\n                            const cell = gameState.board[row][col];\n                            if (cell.chip) {\n                                socket.emit(\"error\", {\n                                    message: \"Space already occupied\"\n                                });\n                                return;\n                            }\n                            // Place the chip\n                            gameState.board[row][col].chip = playerKey;\n                            // Check for sequence\n                            const sequenceResult = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.checkForSequence)(gameState.board, row, col, playerKey);\n                            if (sequenceResult.hasSequence && sequenceResult.sequence) {\n                                gameState[playerKey].sequences.push({\n                                    ...sequenceResult.sequence,\n                                    player: playerKey\n                                });\n                                // Check for win (2 sequences)\n                                if (gameState[playerKey].sequences.length >= 2) {\n                                    gameState.status = \"completed\";\n                                    gameState.winner = socket.id;\n                                }\n                            }\n                        }\n                    } else {\n                        // Regular card: Place chip on matching card\n                        if (!position) {\n                            socket.emit(\"error\", {\n                                message: \"Position required\"\n                            });\n                            return;\n                        }\n                        const { row, col } = position;\n                        const cell = gameState.board[row][col];\n                        if (cell.chip) {\n                            socket.emit(\"error\", {\n                                message: \"Space already occupied\"\n                            });\n                            return;\n                        }\n                        if (!cell.card || cell.card.rank !== card.rank || cell.card.suit !== card.suit) {\n                            socket.emit(\"error\", {\n                                message: \"Card does not match board position\"\n                            });\n                            return;\n                        }\n                        // Place the chip\n                        gameState.board[row][col].chip = playerKey;\n                        // Check for sequence\n                        const sequenceResult = (0,_utils_game__WEBPACK_IMPORTED_MODULE_2__.checkForSequence)(gameState.board, row, col, playerKey);\n                        if (sequenceResult.hasSequence && sequenceResult.sequence) {\n                            gameState[playerKey].sequences.push({\n                                ...sequenceResult.sequence,\n                                player: playerKey\n                            });\n                            // Check for win (2 sequences)\n                            if (gameState[playerKey].sequences.length >= 2) {\n                                gameState.status = \"completed\";\n                                gameState.winner = socket.id;\n                            }\n                        }\n                    }\n                    // Remove card from hand and draw a new one\n                    hands[playerIndex].splice(handIndex, 1);\n                    if (deck.length > 0) {\n                        const newCard = deck.pop();\n                        hands[playerIndex].push(newCard);\n                    }\n                    // Switch turns\n                    gameState.currentTurn = gameState[opponentKey].id;\n                    // Update game state in memory\n                    activeGames.set(roomCode, {\n                        gameState,\n                        deck,\n                        hands\n                    });\n                    // Send updated game state to all clients in the room\n                    io.to(roomCode).emit(\"gameStateUpdate\", {\n                        gameState,\n                        players: [\n                            {\n                                id: gameState.player1.id,\n                                hand: hands[0]\n                            },\n                            {\n                                id: gameState.player2.id,\n                                hand: hands[1]\n                            }\n                        ]\n                    });\n                    // If game is completed, update database\n                    if (gameState.status === \"completed\") {\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].game.update({\n                            where: {\n                                roomCode\n                            },\n                            data: {\n                                status: \"completed\"\n                            }\n                        });\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].gameState.update({\n                            where: {\n                                gameId: (await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].game.findUnique({\n                                    where: {\n                                        roomCode\n                                    }\n                                })).id\n                            },\n                            data: {\n                                winner: gameState.winner,\n                                sequences: gameState.player1.sequences.concat(gameState.player2.sequences)\n                            }\n                        });\n                    }\n                } catch (error) {\n                    console.error(\"Error playing card:\", error);\n                    socket.emit(\"error\", {\n                        message: \"Failed to play card\"\n                    });\n                }\n            });\n            // Disconnect\n            socket.on(\"disconnect\", ()=>{\n                console.log(\"Client disconnected:\", socket.id);\n            });\n        });\n    }\n    return io;\n};\nasync function GET(req) {\n    // Initialize Socket.io server\n    const socketIo = initSocketServer();\n    // Handle the Socket.io upgrade\n    if (req.headers.get(\"upgrade\") === \"websocket\") {\n        const res = new Response(null, {\n            status: 101\n        });\n        return res;\n    }\n    return new Response(\"Socket.io server is running\", {\n        status: 200\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsRUFBSUQsRUFBRTs0QkFBQzs0QkFDN0U2QyxNQUFNO2dDQUNKakIsUUFBUWxCLFVBQVVrQixNQUFNO2dDQUN4QkosV0FBV2QsVUFBVWEsT0FBTyxDQUFDQyxTQUFTLENBQUNtRCxNQUFNLENBQUNqRSxVQUFVaUIsT0FBTyxDQUFDSCxTQUFTOzRCQUMzRTt3QkFDRjtvQkFDRjtnQkFDRixFQUFFLE9BQU9hLE9BQU87b0JBQ2R2QyxRQUFRdUMsS0FBSyxDQUFDLHVCQUF1QkE7b0JBQ3JDeEMsT0FBT2MsSUFBSSxDQUFDLFNBQVM7d0JBQUVDLFNBQVM7b0JBQXNCO2dCQUN4RDtZQUNGO1lBRUEsYUFBYTtZQUNiZixPQUFPRCxFQUFFLENBQUMsY0FBYztnQkFDdEJFLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JGLE9BQU9HLEVBQUU7WUFDL0M7UUFDRTtJQUNGO0lBRUEsT0FBT2I7QUFDVDtBQUVPLGVBQWV5RixJQUFJQyxHQUFnQjtJQUN4Qyw4QkFBOEI7SUFDOUIsTUFBTUMsV0FBV3hGO0lBRWpCLCtCQUErQjtJQUMvQixJQUFJdUYsSUFBSUUsT0FBTyxDQUFDMUIsR0FBRyxDQUFDLGVBQWUsYUFBYTtRQUM5QyxNQUFNMkIsTUFBTSxJQUFJQyxTQUFTLE1BQU07WUFBRTdELFFBQVE7UUFBSTtRQUM3QyxPQUFPNEQ7SUFDVDtJQUVBLE9BQU8sSUFBSUMsU0FBUywrQkFBK0I7UUFBRTdELFFBQVE7SUFBSTtBQUNuRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlcXVlbmNlLWdhbWUvLi9zcmMvYXBwL2FwaS9zb2NrZXQvcm91dGUudHM/YmQ5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IFNlcnZlciBhcyBTb2NrZXRJT1NlcnZlciB9IGZyb20gJ3NvY2tldC5pbyc7XG5pbXBvcnQgcHJpc21hIGZyb20gJ0AvbGliL3ByaXNtYSc7XG5pbXBvcnQgeyBjcmVhdGVEZWNrLCBzaHVmZmxlRGVjaywgZGVhbENhcmRzLCBjcmVhdGVHYW1lQm9hcmQsIGNoZWNrRm9yU2VxdWVuY2UgfSBmcm9tICdAL3V0aWxzL2dhbWUnO1xuaW1wb3J0IHsgQ2FyZCwgR2FtZVN0YXRlIH0gZnJvbSAnQC90eXBlcy9nYW1lJztcblxuLy8gU29ja2V0LmlvIHNlcnZlciBpbnN0YW5jZVxubGV0IGlvOiBTb2NrZXRJT1NlcnZlcjtcblxuLy8gU3RvcmUgYWN0aXZlIGdhbWVzIGluIG1lbW9yeVxuY29uc3QgYWN0aXZlR2FtZXMgPSBuZXcgTWFwKCk7XG5cbi8vIFNvY2tldC5pbyBzZXJ2ZXIgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb25cbmNvbnN0IGluaXRTb2NrZXRTZXJ2ZXIgPSAoKSA9PiB7XG4gIGlmICghaW8pIHtcbiAgICBpbyA9IG5ldyBTb2NrZXRJT1NlcnZlcih7XG4gICAgICBwYXRoOiAnL2FwaS9zb2NrZXQnLFxuICAgICAgYWRkVHJhaWxpbmdTbGFzaDogZmFsc2UsXG4gICAgICBjb3JzOiB7XG4gICAgICAgIG9yaWdpbjogJyonLFxuICAgICAgICBtZXRob2RzOiBbJ0dFVCcsICdQT1NUJ10sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaW8ub24oJ2Nvbm5lY3Rpb24nLCAoc29ja2V0KSA9PiB7XG4gIGNvbnNvbGUubG9nKCdDbGllbnQgY29ubmVjdGVkOicsIHNvY2tldC5pZCk7XG5cbiAgLy8gSm9pbiBhIHJvb21cbiAgc29ja2V0Lm9uKCdqb2luUm9vbScsIGFzeW5jICh7IHJvb21Db2RlIH0pID0+IHtcbiAgICB0cnkge1xuICAgICAgc29ja2V0LmpvaW4ocm9vbUNvZGUpO1xuXG4gICAgICAvLyBHZXQgZ2FtZSBkYXRhIGZyb20gZGF0YWJhc2VcbiAgICAgIGNvbnN0IGdhbWUgPSBhd2FpdCBwcmlzbWEuZ2FtZS5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgcm9vbUNvZGUgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGhvc3Q6IHRydWUsXG4gICAgICAgICAgcGxheWVyVG9HYW1lOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHBsYXllcjogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBnYW1lU3RhdGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFnYW1lKSB7XG4gICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ1Jvb20gbm90IGZvdW5kJyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBGb3JtYXQgcGxheWVycyBkYXRhXG4gICAgICBjb25zdCBwbGF5ZXJzID0gZ2FtZS5wbGF5ZXJUb0dhbWUubWFwKChwdGcpID0+ICh7XG4gICAgICAgIGlkOiBwdGcucGxheWVyLmlkLFxuICAgICAgICBuYW1lOiBwdGcucGxheWVyLm5hbWUsXG4gICAgICAgIGlzSG9zdDogcHRnLnBsYXllci5pZCA9PT0gZ2FtZS5ob3N0SWQsXG4gICAgICAgIGhhbmQ6IFtdLCAvLyBXaWxsIGJlIHBvcHVsYXRlZCBpZiBnYW1lIGlzIGluIHByb2dyZXNzXG4gICAgICB9KSk7XG5cbiAgICAgIC8vIEdldCBvciBpbml0aWFsaXplIGdhbWUgc3RhdGVcbiAgICAgIGxldCBnYW1lU3RhdGUgPSBudWxsO1xuXG4gICAgICBpZiAoZ2FtZS5nYW1lU3RhdGUpIHtcbiAgICAgICAgZ2FtZVN0YXRlID0ge1xuICAgICAgICAgIHN0YXR1czogZ2FtZS5zdGF0dXMgYXMgJ3dhaXRpbmcnIHwgJ3BsYXlpbmcnIHwgJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgYm9hcmQ6IGdhbWUuZ2FtZVN0YXRlLmJvYXJkIGFzIGFueSxcbiAgICAgICAgICBjdXJyZW50VHVybjogZ2FtZS5nYW1lU3RhdGUuY3VycmVudFR1cm4sXG4gICAgICAgICAgcGxheWVyMToge1xuICAgICAgICAgICAgaWQ6IHBsYXllcnNbMF0/LmlkLFxuICAgICAgICAgICAgc2VxdWVuY2VzOiAoZ2FtZS5nYW1lU3RhdGUuc2VxdWVuY2VzIGFzIGFueSkuZmlsdGVyKChzOiBhbnkpID0+IHMucGxheWVyID09PSAncGxheWVyMScpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGxheWVyMjoge1xuICAgICAgICAgICAgaWQ6IHBsYXllcnNbMV0/LmlkLFxuICAgICAgICAgICAgc2VxdWVuY2VzOiAoZ2FtZS5nYW1lU3RhdGUuc2VxdWVuY2VzIGFzIGFueSkuZmlsdGVyKChzOiBhbnkpID0+IHMucGxheWVyID09PSAncGxheWVyMicpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgd2lubmVyOiBnYW1lLmdhbWVTdGF0ZS53aW5uZXIsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gSWYgZ2FtZSBpcyBpbiBwcm9ncmVzcywgZ2V0IHBsYXllciBoYW5kc1xuICAgICAgICBpZiAoZ2FtZS5zdGF0dXMgPT09ICdwbGF5aW5nJykge1xuICAgICAgICAgIGNvbnN0IHBsYXllcjFIYW5kID0gZ2FtZS5nYW1lU3RhdGUucGxheWVyMUhhbmQgYXMgYW55O1xuICAgICAgICAgIGNvbnN0IHBsYXllcjJIYW5kID0gZ2FtZS5nYW1lU3RhdGUucGxheWVyMkhhbmQgYXMgYW55O1xuXG4gICAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCBwbGF5ZXJcbiAgICAgICAgICBjb25zdCBjdXJyZW50UGxheWVySW5kZXggPSBwbGF5ZXJzLmZpbmRJbmRleCgocCkgPT4gcC5pZCA9PT0gc29ja2V0LmlkKTtcblxuICAgICAgICAgIGlmIChjdXJyZW50UGxheWVySW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHBsYXllcnNbMF0uaGFuZCA9IHBsYXllcjFIYW5kO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFBsYXllckluZGV4ID09PSAxKSB7XG4gICAgICAgICAgICBwbGF5ZXJzWzFdLmhhbmQgPSBwbGF5ZXIySGFuZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gU2VuZCByb29tIGRhdGEgdG8gdGhlIGNsaWVudFxuICAgICAgc29ja2V0LmVtaXQoJ3Jvb21EYXRhJywge1xuICAgICAgICBwbGF5ZXJzLFxuICAgICAgICBnYW1lU3RhdGUsXG4gICAgICAgIGN1cnJlbnRQbGF5ZXI6IHBsYXllcnMuZmluZCgocCkgPT4gcC5pZCA9PT0gc29ja2V0LmlkKSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBOb3RpZnkgb3RoZXIgY2xpZW50cyBpbiB0aGUgcm9vbVxuICAgICAgc29ja2V0LnRvKHJvb21Db2RlKS5lbWl0KCdwbGF5ZXJKb2luZWQnLCB7XG4gICAgICAgIHBsYXllcnMsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igam9pbmluZyByb29tOicsIGVycm9yKTtcbiAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ0ZhaWxlZCB0byBqb2luIHJvb20nIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gU3RhcnQgdGhlIGdhbWVcbiAgc29ja2V0Lm9uKCdzdGFydEdhbWUnLCBhc3luYyAoeyByb29tQ29kZSB9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBnYW1lIGRhdGEgZnJvbSBkYXRhYmFzZVxuICAgICAgY29uc3QgZ2FtZSA9IGF3YWl0IHByaXNtYS5nYW1lLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyByb29tQ29kZSB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgcGxheWVyVG9HYW1lOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHBsYXllcjogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWdhbWUpIHtcbiAgICAgICAgc29ja2V0LmVtaXQoJ2Vycm9yJywgeyBtZXNzYWdlOiAnUm9vbSBub3QgZm91bmQnIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChnYW1lLmhvc3RJZCAhPT0gc29ja2V0LmlkKSB7XG4gICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ09ubHkgdGhlIGhvc3QgY2FuIHN0YXJ0IHRoZSBnYW1lJyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZ2FtZS5wbGF5ZXJUb0dhbWUubGVuZ3RoIDwgMikge1xuICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdOZWVkIGF0IGxlYXN0IDIgcGxheWVycyB0byBzdGFydCcgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKGdhbWUuc3RhdHVzICE9PSAnd2FpdGluZycpIHtcbiAgICAgICAgc29ja2V0LmVtaXQoJ2Vycm9yJywgeyBtZXNzYWdlOiAnR2FtZSBoYXMgYWxyZWFkeSBzdGFydGVkJyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJbml0aWFsaXplIHRoZSBnYW1lXG4gICAgICBjb25zdCBkZWNrID0gY3JlYXRlRGVjaygpO1xuICAgICAgY29uc3Qgc2h1ZmZsZWREZWNrID0gc2h1ZmZsZURlY2soZGVjayk7XG4gICAgICBjb25zdCB7IGhhbmRzLCByZW1haW5pbmdEZWNrIH0gPSBkZWFsQ2FyZHMoc2h1ZmZsZWREZWNrLCAyKTtcbiAgICAgIGNvbnN0IGJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKCk7XG5cbiAgICAgIC8vIENyZWF0ZSBnYW1lIHN0YXRlXG4gICAgICBjb25zdCBnYW1lU3RhdGU6IEdhbWVTdGF0ZSA9IHtcbiAgICAgICAgc3RhdHVzOiAncGxheWluZycsXG4gICAgICAgIGJvYXJkLFxuICAgICAgICBjdXJyZW50VHVybjogZ2FtZS5wbGF5ZXJUb0dhbWVbMF0ucGxheWVySWQsIC8vIEZpcnN0IHBsYXllciBzdGFydHNcbiAgICAgICAgcGxheWVyMToge1xuICAgICAgICAgIGlkOiBnYW1lLnBsYXllclRvR2FtZVswXS5wbGF5ZXJJZCxcbiAgICAgICAgICBzZXF1ZW5jZXM6IFtdLFxuICAgICAgICB9LFxuICAgICAgICBwbGF5ZXIyOiB7XG4gICAgICAgICAgaWQ6IGdhbWUucGxheWVyVG9HYW1lWzFdLnBsYXllcklkLFxuICAgICAgICAgIHNlcXVlbmNlczogW10sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICAvLyBTYXZlIGdhbWUgc3RhdGUgdG8gZGF0YWJhc2VcbiAgICAgIGF3YWl0IHByaXNtYS5nYW1lU3RhdGUuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGdhbWVJZDogZ2FtZS5pZCxcbiAgICAgICAgICBjdXJyZW50VHVybjogZ2FtZVN0YXRlLmN1cnJlbnRUdXJuLFxuICAgICAgICAgIGJvYXJkOiBnYW1lU3RhdGUuYm9hcmQgYXMgYW55LFxuICAgICAgICAgIGRlY2s6IHJlbWFpbmluZ0RlY2sgYXMgYW55LFxuICAgICAgICAgIHBsYXllcjFIYW5kOiBoYW5kc1swXSBhcyBhbnksXG4gICAgICAgICAgcGxheWVyMkhhbmQ6IGhhbmRzWzFdIGFzIGFueSxcbiAgICAgICAgICBzZXF1ZW5jZXM6IFtdIGFzIGFueSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBVcGRhdGUgZ2FtZSBzdGF0dXNcbiAgICAgIGF3YWl0IHByaXNtYS5nYW1lLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBnYW1lLmlkIH0sXG4gICAgICAgIGRhdGE6IHsgc3RhdHVzOiAncGxheWluZycgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTdG9yZSBnYW1lIHN0YXRlIGluIG1lbW9yeVxuICAgICAgYWN0aXZlR2FtZXMuc2V0KHJvb21Db2RlLCB7XG4gICAgICAgIGdhbWVTdGF0ZSxcbiAgICAgICAgZGVjazogcmVtYWluaW5nRGVjayxcbiAgICAgICAgaGFuZHMsXG4gICAgICB9KTtcblxuICAgICAgLy8gU2VuZCBnYW1lIHN0YXRlIHRvIGFsbCBjbGllbnRzIGluIHRoZSByb29tXG4gICAgICBpby50byhyb29tQ29kZSkuZW1pdCgnZ2FtZVN0YXJ0ZWQnLCB7XG4gICAgICAgIGdhbWVTdGF0ZSxcbiAgICAgICAgcGxheWVyczogZ2FtZS5wbGF5ZXJUb0dhbWUubWFwKChwdGcsIGluZGV4KSA9PiAoe1xuICAgICAgICAgIGlkOiBwdGcucGxheWVyLmlkLFxuICAgICAgICAgIG5hbWU6IHB0Zy5wbGF5ZXIubmFtZSxcbiAgICAgICAgICBpc0hvc3Q6IHB0Zy5wbGF5ZXIuaWQgPT09IGdhbWUuaG9zdElkLFxuICAgICAgICAgIGhhbmQ6IGhhbmRzW2luZGV4XSxcbiAgICAgICAgfSkpLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YXJ0aW5nIGdhbWU6JywgZXJyb3IpO1xuICAgICAgc29ja2V0LmVtaXQoJ2Vycm9yJywgeyBtZXNzYWdlOiAnRmFpbGVkIHRvIHN0YXJ0IGdhbWUnIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gUGxheSBhIGNhcmRcbiAgc29ja2V0Lm9uKCdwbGF5Q2FyZCcsIGFzeW5jICh7IHJvb21Db2RlLCBjYXJkLCBwb3NpdGlvbiB9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBhY3RpdmUgZ2FtZSBmcm9tIG1lbW9yeVxuICAgICAgY29uc3QgYWN0aXZlR2FtZSA9IGFjdGl2ZUdhbWVzLmdldChyb29tQ29kZSk7XG5cbiAgICAgIGlmICghYWN0aXZlR2FtZSkge1xuICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdHYW1lIG5vdCBmb3VuZCcgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBnYW1lU3RhdGUsIGRlY2ssIGhhbmRzIH0gPSBhY3RpdmVHYW1lO1xuXG4gICAgICBpZiAoZ2FtZVN0YXRlLnN0YXR1cyAhPT0gJ3BsYXlpbmcnKSB7XG4gICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ0dhbWUgaXMgbm90IGluIHByb2dyZXNzJyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZ2FtZVN0YXRlLmN1cnJlbnRUdXJuICE9PSBzb2NrZXQuaWQpIHtcbiAgICAgICAgc29ja2V0LmVtaXQoJ2Vycm9yJywgeyBtZXNzYWdlOiAnTm90IHlvdXIgdHVybicgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gRGV0ZXJtaW5lIHBsYXllciBpbmRleCAoMCBvciAxKVxuICAgICAgY29uc3QgcGxheWVySW5kZXggPSBnYW1lU3RhdGUucGxheWVyMS5pZCA9PT0gc29ja2V0LmlkID8gMCA6IDE7XG4gICAgICBjb25zdCBwbGF5ZXJLZXkgPSBwbGF5ZXJJbmRleCA9PT0gMCA/ICdwbGF5ZXIxJyA6ICdwbGF5ZXIyJztcbiAgICAgIGNvbnN0IG9wcG9uZW50S2V5ID0gcGxheWVySW5kZXggPT09IDAgPyAncGxheWVyMicgOiAncGxheWVyMSc7XG5cbiAgICAgIC8vIENoZWNrIGlmIHBsYXllciBoYXMgdGhlIGNhcmRcbiAgICAgIGNvbnN0IGhhbmRJbmRleCA9IGhhbmRzW3BsYXllckluZGV4XS5maW5kSW5kZXgoKGMpID0+IGMuaWQgPT09IGNhcmQuaWQpO1xuXG4gICAgICBpZiAoaGFuZEluZGV4ID09PSAtMSkge1xuICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdDYXJkIG5vdCBpbiBoYW5kJyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgY2FyZCBwbGF5IGJhc2VkIG9uIHR5cGVcbiAgICAgIGlmIChjYXJkLmlzSmFjaykge1xuICAgICAgICBpZiAoY2FyZC5qYWNrVHlwZSA9PT0gJ29uZS1leWVkJykge1xuICAgICAgICAgIC8vIE9uZS1leWVkIEphY2s6IFJlbW92ZSBvcHBvbmVudCdzIGNoaXBcbiAgICAgICAgICBpZiAoIXBvc2l0aW9uKSB7XG4gICAgICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdQb3NpdGlvbiByZXF1aXJlZCBmb3Igb25lLWV5ZWQgSmFjaycgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgeyByb3csIGNvbCB9ID0gcG9zaXRpb247XG4gICAgICAgICAgY29uc3QgY2VsbCA9IGdhbWVTdGF0ZS5ib2FyZFtyb3ddW2NvbF07XG5cbiAgICAgICAgICBpZiAoIWNlbGwuY2hpcCB8fCBjZWxsLmNoaXAgPT09IHBsYXllcktleSkge1xuICAgICAgICAgICAgc29ja2V0LmVtaXQoJ2Vycm9yJywgeyBtZXNzYWdlOiAnQ2FuIG9ubHkgcmVtb3ZlIG9wcG9uZW50XFwncyBjaGlwcycgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjaGlwXG4gICAgICAgICAgZ2FtZVN0YXRlLmJvYXJkW3Jvd11bY29sXS5jaGlwID0gdW5kZWZpbmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFR3by1leWVkIEphY2s6IFBsYWNlIGNoaXAgYW55d2hlcmVcbiAgICAgICAgICBpZiAoIXBvc2l0aW9uKSB7XG4gICAgICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdQb3NpdGlvbiByZXF1aXJlZCBmb3IgdHdvLWV5ZWQgSmFjaycgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgeyByb3csIGNvbCB9ID0gcG9zaXRpb247XG4gICAgICAgICAgY29uc3QgY2VsbCA9IGdhbWVTdGF0ZS5ib2FyZFtyb3ddW2NvbF07XG5cbiAgICAgICAgICBpZiAoY2VsbC5jaGlwKSB7XG4gICAgICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCB7IG1lc3NhZ2U6ICdTcGFjZSBhbHJlYWR5IG9jY3VwaWVkJyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBQbGFjZSB0aGUgY2hpcFxuICAgICAgICAgIGdhbWVTdGF0ZS5ib2FyZFtyb3ddW2NvbF0uY2hpcCA9IHBsYXllcktleTtcblxuICAgICAgICAgIC8vIENoZWNrIGZvciBzZXF1ZW5jZVxuICAgICAgICAgIGNvbnN0IHNlcXVlbmNlUmVzdWx0ID0gY2hlY2tGb3JTZXF1ZW5jZShnYW1lU3RhdGUuYm9hcmQsIHJvdywgY29sLCBwbGF5ZXJLZXkpO1xuXG4gICAgICAgICAgaWYgKHNlcXVlbmNlUmVzdWx0Lmhhc1NlcXVlbmNlICYmIHNlcXVlbmNlUmVzdWx0LnNlcXVlbmNlKSB7XG4gICAgICAgICAgICBnYW1lU3RhdGVbcGxheWVyS2V5XS5zZXF1ZW5jZXMucHVzaCh7XG4gICAgICAgICAgICAgIC4uLnNlcXVlbmNlUmVzdWx0LnNlcXVlbmNlLFxuICAgICAgICAgICAgICBwbGF5ZXI6IHBsYXllcktleSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3Igd2luICgyIHNlcXVlbmNlcylcbiAgICAgICAgICAgIGlmIChnYW1lU3RhdGVbcGxheWVyS2V5XS5zZXF1ZW5jZXMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgICAgZ2FtZVN0YXRlLnN0YXR1cyA9ICdjb21wbGV0ZWQnO1xuICAgICAgICAgICAgICBnYW1lU3RhdGUud2lubmVyID0gc29ja2V0LmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVndWxhciBjYXJkOiBQbGFjZSBjaGlwIG9uIG1hdGNoaW5nIGNhcmRcbiAgICAgICAgaWYgKCFwb3NpdGlvbikge1xuICAgICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ1Bvc2l0aW9uIHJlcXVpcmVkJyB9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IHJvdywgY29sIH0gPSBwb3NpdGlvbjtcbiAgICAgICAgY29uc3QgY2VsbCA9IGdhbWVTdGF0ZS5ib2FyZFtyb3ddW2NvbF07XG5cbiAgICAgICAgaWYgKGNlbGwuY2hpcCkge1xuICAgICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ1NwYWNlIGFscmVhZHkgb2NjdXBpZWQnIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY2VsbC5jYXJkIHx8IGNlbGwuY2FyZC5yYW5rICE9PSBjYXJkLnJhbmsgfHwgY2VsbC5jYXJkLnN1aXQgIT09IGNhcmQuc3VpdCkge1xuICAgICAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ0NhcmQgZG9lcyBub3QgbWF0Y2ggYm9hcmQgcG9zaXRpb24nIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBsYWNlIHRoZSBjaGlwXG4gICAgICAgIGdhbWVTdGF0ZS5ib2FyZFtyb3ddW2NvbF0uY2hpcCA9IHBsYXllcktleTtcblxuICAgICAgICAvLyBDaGVjayBmb3Igc2VxdWVuY2VcbiAgICAgICAgY29uc3Qgc2VxdWVuY2VSZXN1bHQgPSBjaGVja0ZvclNlcXVlbmNlKGdhbWVTdGF0ZS5ib2FyZCwgcm93LCBjb2wsIHBsYXllcktleSk7XG5cbiAgICAgICAgaWYgKHNlcXVlbmNlUmVzdWx0Lmhhc1NlcXVlbmNlICYmIHNlcXVlbmNlUmVzdWx0LnNlcXVlbmNlKSB7XG4gICAgICAgICAgZ2FtZVN0YXRlW3BsYXllcktleV0uc2VxdWVuY2VzLnB1c2goe1xuICAgICAgICAgICAgLi4uc2VxdWVuY2VSZXN1bHQuc2VxdWVuY2UsXG4gICAgICAgICAgICBwbGF5ZXI6IHBsYXllcktleSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIENoZWNrIGZvciB3aW4gKDIgc2VxdWVuY2VzKVxuICAgICAgICAgIGlmIChnYW1lU3RhdGVbcGxheWVyS2V5XS5zZXF1ZW5jZXMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgIGdhbWVTdGF0ZS5zdGF0dXMgPSAnY29tcGxldGVkJztcbiAgICAgICAgICAgIGdhbWVTdGF0ZS53aW5uZXIgPSBzb2NrZXQuaWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBjYXJkIGZyb20gaGFuZCBhbmQgZHJhdyBhIG5ldyBvbmVcbiAgICAgIGhhbmRzW3BsYXllckluZGV4XS5zcGxpY2UoaGFuZEluZGV4LCAxKTtcblxuICAgICAgaWYgKGRlY2subGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBuZXdDYXJkID0gZGVjay5wb3AoKSE7XG4gICAgICAgIGhhbmRzW3BsYXllckluZGV4XS5wdXNoKG5ld0NhcmQpO1xuICAgICAgfVxuXG4gICAgICAvLyBTd2l0Y2ggdHVybnNcbiAgICAgIGdhbWVTdGF0ZS5jdXJyZW50VHVybiA9IGdhbWVTdGF0ZVtvcHBvbmVudEtleV0uaWQ7XG5cbiAgICAgIC8vIFVwZGF0ZSBnYW1lIHN0YXRlIGluIG1lbW9yeVxuICAgICAgYWN0aXZlR2FtZXMuc2V0KHJvb21Db2RlLCB7XG4gICAgICAgIGdhbWVTdGF0ZSxcbiAgICAgICAgZGVjayxcbiAgICAgICAgaGFuZHMsXG4gICAgICB9KTtcblxuICAgICAgLy8gU2VuZCB1cGRhdGVkIGdhbWUgc3RhdGUgdG8gYWxsIGNsaWVudHMgaW4gdGhlIHJvb21cbiAgICAgIGlvLnRvKHJvb21Db2RlKS5lbWl0KCdnYW1lU3RhdGVVcGRhdGUnLCB7XG4gICAgICAgIGdhbWVTdGF0ZSxcbiAgICAgICAgcGxheWVyczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiBnYW1lU3RhdGUucGxheWVyMS5pZCxcbiAgICAgICAgICAgIGhhbmQ6IGhhbmRzWzBdLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6IGdhbWVTdGF0ZS5wbGF5ZXIyLmlkLFxuICAgICAgICAgICAgaGFuZDogaGFuZHNbMV0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJZiBnYW1lIGlzIGNvbXBsZXRlZCwgdXBkYXRlIGRhdGFiYXNlXG4gICAgICBpZiAoZ2FtZVN0YXRlLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLmdhbWUudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyByb29tQ29kZSB9LFxuICAgICAgICAgIGRhdGE6IHsgc3RhdHVzOiAnY29tcGxldGVkJyB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBwcmlzbWEuZ2FtZVN0YXRlLnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgZ2FtZUlkOiAoYXdhaXQgcHJpc21hLmdhbWUuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHJvb21Db2RlIH0gfSkpIS5pZCB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHdpbm5lcjogZ2FtZVN0YXRlLndpbm5lcixcbiAgICAgICAgICAgIHNlcXVlbmNlczogZ2FtZVN0YXRlLnBsYXllcjEuc2VxdWVuY2VzLmNvbmNhdChnYW1lU3RhdGUucGxheWVyMi5zZXF1ZW5jZXMpIGFzIGFueSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGxheWluZyBjYXJkOicsIGVycm9yKTtcbiAgICAgIHNvY2tldC5lbWl0KCdlcnJvcicsIHsgbWVzc2FnZTogJ0ZhaWxlZCB0byBwbGF5IGNhcmQnIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gRGlzY29ubmVjdFxuICBzb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ0NsaWVudCBkaXNjb25uZWN0ZWQ6Jywgc29ja2V0LmlkKTtcbiAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gaW87XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgLy8gSW5pdGlhbGl6ZSBTb2NrZXQuaW8gc2VydmVyXG4gIGNvbnN0IHNvY2tldElvID0gaW5pdFNvY2tldFNlcnZlcigpO1xuXG4gIC8vIEhhbmRsZSB0aGUgU29ja2V0LmlvIHVwZ3JhZGVcbiAgaWYgKHJlcS5oZWFkZXJzLmdldCgndXBncmFkZScpID09PSAnd2Vic29ja2V0Jykge1xuICAgIGNvbnN0IHJlcyA9IG5ldyBSZXNwb25zZShudWxsLCB7IHN0YXR1czogMTAxIH0pO1xuICAgIHJldHVybiByZXM7XG4gIH1cblxuICByZXR1cm4gbmV3IFJlc3BvbnNlKCdTb2NrZXQuaW8gc2VydmVyIGlzIHJ1bm5pbmcnLCB7IHN0YXR1czogMjAwIH0pO1xufVxuIl0sIm5hbWVzIjpbIlNlcnZlciIsIlNvY2tldElPU2VydmVyIiwicHJpc21hIiwiY3JlYXRlRGVjayIsInNodWZmbGVEZWNrIiwiZGVhbENhcmRzIiwiY3JlYXRlR2FtZUJvYXJkIiwiY2hlY2tGb3JTZXF1ZW5jZSIsImlvIiwiYWN0aXZlR2FtZXMiLCJNYXAiLCJpbml0U29ja2V0U2VydmVyIiwicGF0aCIsImFkZFRyYWlsaW5nU2xhc2giLCJjb3JzIiwib3JpZ2luIiwibWV0aG9kcyIsIm9uIiwic29ja2V0IiwiY29uc29sZSIsImxvZyIsImlkIiwicm9vbUNvZGUiLCJqb2luIiwiZ2FtZSIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJob3N0IiwicGxheWVyVG9HYW1lIiwicGxheWVyIiwiZ2FtZVN0YXRlIiwiZW1pdCIsIm1lc3NhZ2UiLCJwbGF5ZXJzIiwibWFwIiwicHRnIiwibmFtZSIsImlzSG9zdCIsImhvc3RJZCIsImhhbmQiLCJzdGF0dXMiLCJib2FyZCIsImN1cnJlbnRUdXJuIiwicGxheWVyMSIsInNlcXVlbmNlcyIsImZpbHRlciIsInMiLCJwbGF5ZXIyIiwid2lubmVyIiwicGxheWVyMUhhbmQiLCJwbGF5ZXIySGFuZCIsImN1cnJlbnRQbGF5ZXJJbmRleCIsImZpbmRJbmRleCIsInAiLCJjdXJyZW50UGxheWVyIiwiZmluZCIsInRvIiwiZXJyb3IiLCJsZW5ndGgiLCJkZWNrIiwic2h1ZmZsZWREZWNrIiwiaGFuZHMiLCJyZW1haW5pbmdEZWNrIiwicGxheWVySWQiLCJjcmVhdGUiLCJkYXRhIiwiZ2FtZUlkIiwidXBkYXRlIiwic2V0IiwiaW5kZXgiLCJjYXJkIiwicG9zaXRpb24iLCJhY3RpdmVHYW1lIiwiZ2V0IiwicGxheWVySW5kZXgiLCJwbGF5ZXJLZXkiLCJvcHBvbmVudEtleSIsImhhbmRJbmRleCIsImMiLCJpc0phY2siLCJqYWNrVHlwZSIsInJvdyIsImNvbCIsImNlbGwiLCJjaGlwIiwidW5kZWZpbmVkIiwic2VxdWVuY2VSZXN1bHQiLCJoYXNTZXF1ZW5jZSIsInNlcXVlbmNlIiwicHVzaCIsInJhbmsiLCJzdWl0Iiwic3BsaWNlIiwibmV3Q2FyZCIsInBvcCIsImNvbmNhdCIsIkdFVCIsInJlcSIsInNvY2tldElvIiwiaGVhZGVycyIsInJlcyIsIlJlc3BvbnNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/socket/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// PrismaClient is attached to the `global` object in development to prevent\n// exhausting your database connection limit.\nconst globalForPrisma = global;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQThDO0FBRTlDLDRFQUE0RTtBQUM1RSw2Q0FBNkM7QUFDN0MsTUFBTUMsa0JBQWtCQztBQUVqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsR0FBRztBQUVuRSxJQUFJSSxJQUF5QixFQUFjSCxnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsaUVBQWVBLE1BQU1BLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZXF1ZW5jZS1nYW1lLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbi8vIFByaXNtYUNsaWVudCBpcyBhdHRhY2hlZCB0byB0aGUgYGdsb2JhbGAgb2JqZWN0IGluIGRldmVsb3BtZW50IHRvIHByZXZlbnRcbi8vIGV4aGF1c3RpbmcgeW91ciBkYXRhYmFzZSBjb25uZWN0aW9uIGxpbWl0LlxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBwcmlzbWE6IFByaXNtYUNsaWVudCB9O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fCBuZXcgUHJpc21hQ2xpZW50KCk7XG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hO1xuXG5leHBvcnQgZGVmYXVsdCBwcmlzbWE7XG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/game.ts":
/*!***************************!*\
  !*** ./src/utils/game.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkForSequence: () => (/* binding */ checkForSequence),\n/* harmony export */   createDeck: () => (/* binding */ createDeck),\n/* harmony export */   createGameBoard: () => (/* binding */ createGameBoard),\n/* harmony export */   dealCards: () => (/* binding */ dealCards),\n/* harmony export */   generateRoomCode: () => (/* binding */ generateRoomCode),\n/* harmony export */   shuffleDeck: () => (/* binding */ shuffleDeck)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n\n// Generate a random 6-character room code\nfunction generateRoomCode() {\n    const characters = \"ABCDEFGHJKLMNPQRSTUVWXYZ23456789\"; // Removed similar looking characters\n    let result = \"\";\n    for(let i = 0; i < 6; i++){\n        result += characters.charAt(Math.floor(Math.random() * characters.length));\n    }\n    return result;\n}\n// Create a deck of cards\nfunction createDeck() {\n    const suits = [\n        \"hearts\",\n        \"diamonds\",\n        \"clubs\",\n        \"spades\"\n    ];\n    const ranks = [\n        \"A\",\n        \"2\",\n        \"3\",\n        \"4\",\n        \"5\",\n        \"6\",\n        \"7\",\n        \"8\",\n        \"9\",\n        \"10\",\n        \"J\",\n        \"Q\",\n        \"K\"\n    ];\n    const deck = [];\n    // Create two decks (104 cards)\n    for(let i = 0; i < 2; i++){\n        for (const suit of suits){\n            for (const rank of ranks){\n                const card = {\n                    suit,\n                    rank,\n                    id: (0,uuid__WEBPACK_IMPORTED_MODULE_0__[\"default\"])()\n                };\n                // Mark Jacks\n                if (rank === \"J\") {\n                    card.isJack = true;\n                    // One-eyed Jacks: Jack of Hearts and Jack of Spades\n                    if (suit === \"hearts\" || suit === \"spades\") {\n                        card.jackType = \"one-eyed\";\n                    } else {\n                        card.jackType = \"two-eyed\";\n                    }\n                }\n                deck.push(card);\n            }\n        }\n    }\n    return deck;\n}\n// Shuffle a deck of cards\nfunction shuffleDeck(deck) {\n    const shuffled = [\n        ...deck\n    ];\n    for(let i = shuffled.length - 1; i > 0; i--){\n        const j = Math.floor(Math.random() * (i + 1));\n        [shuffled[i], shuffled[j]] = [\n            shuffled[j],\n            shuffled[i]\n        ];\n    }\n    return shuffled;\n}\n// Deal cards to players\nfunction dealCards(deck, numPlayers) {\n    const hands = [];\n    const cardsPerPlayer = 7; // For a 2-player game\n    for(let i = 0; i < numPlayers; i++){\n        hands.push([]);\n    }\n    for(let i = 0; i < cardsPerPlayer; i++){\n        for(let j = 0; j < numPlayers; j++){\n            if (deck.length > 0) {\n                const card = deck.pop();\n                hands[j].push(card);\n            }\n        }\n    }\n    return {\n        hands,\n        remainingDeck: deck\n    };\n}\n// Create the initial game board\nfunction createGameBoard() {\n    const board = [];\n    const size = 10; // 10x10 board\n    for(let i = 0; i < size; i++){\n        board.push([]);\n        for(let j = 0; j < size; j++){\n            const cell = {};\n            // Mark corner cells as free spaces\n            if (i === 0 && j === 0 || i === 0 && j === size - 1 || i === size - 1 && j === 0 || i === size - 1 && j === size - 1) {\n                cell.isCorner = true;\n            }\n            board[i].push(cell);\n        }\n    }\n    return board;\n}\n// Check if a sequence is formed\nfunction checkForSequence(board, row, col, player) {\n    const directions = [\n        [\n            0,\n            1\n        ],\n        [\n            1,\n            0\n        ],\n        [\n            1,\n            1\n        ],\n        [\n            1,\n            -1\n        ]\n    ];\n    for (const [dx, dy] of directions){\n        let count = 1;\n        let startRow = row;\n        let startCol = col;\n        let endRow = row;\n        let endCol = col;\n        // Check in positive direction\n        for(let i = 1; i < 5; i++){\n            const newRow = row + i * dx;\n            const newCol = col + i * dy;\n            if (newRow < 0 || newRow >= board.length || newCol < 0 || newCol >= board[0].length || board[newRow][newCol].chip !== player) {\n                break;\n            }\n            count++;\n            endRow = newRow;\n            endCol = newCol;\n        }\n        // Check in negative direction\n        for(let i = 1; i < 5; i++){\n            const newRow = row - i * dx;\n            const newCol = col - i * dy;\n            if (newRow < 0 || newRow >= board.length || newCol < 0 || newCol >= board[0].length || board[newRow][newCol].chip !== player) {\n                break;\n            }\n            count++;\n            startRow = newRow;\n            startCol = newCol;\n        }\n        if (count >= 5) {\n            return {\n                hasSequence: true,\n                sequence: {\n                    startRow,\n                    startCol,\n                    endRow,\n                    endCol\n                }\n            };\n        }\n    }\n    return {\n        hasSequence: false\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTRTtZQUNURCxTQUFTRTtRQUNYO1FBRUEsOEJBQThCO1FBQzlCLElBQUssSUFBSTVDLElBQUksR0FBR0EsSUFBSSxHQUFHQSxJQUFLO1lBQzFCLE1BQU0yQyxTQUFTWCxNQUFNaEMsSUFBSW9DO1lBQ3pCLE1BQU1RLFNBQVNYLE1BQU1qQyxJQUFJcUM7WUFFekIsSUFDRU0sU0FBUyxLQUFLQSxVQUFVaEIsTUFBTXRCLE1BQU0sSUFDcEN1QyxTQUFTLEtBQUtBLFVBQVVqQixLQUFLLENBQUMsRUFBRSxDQUFDdEIsTUFBTSxJQUN2Q3NCLEtBQUssQ0FBQ2dCLE9BQU8sQ0FBQ0MsT0FBTyxDQUFDQyxJQUFJLEtBQUtYLFFBQy9CO2dCQUNBO1lBQ0Y7WUFFQUk7WUFDQUMsV0FBV0k7WUFDWEgsV0FBV0k7UUFDYjtRQUVBLElBQUlOLFNBQVMsR0FBRztZQUNkLE9BQU87Z0JBQ0xRLGFBQWE7Z0JBQ2JDLFVBQVU7b0JBQ1JSO29CQUNBQztvQkFDQUM7b0JBQ0FDO2dCQUNGO1lBQ0Y7UUFDRjtJQUNGO0lBRUEsT0FBTztRQUFFSSxhQUFhO0lBQU07QUFDOUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZXF1ZW5jZS1nYW1lLy4vc3JjL3V0aWxzL2dhbWUudHM/OWFhYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IENhcmQsIENhcmRSYW5rLCBDYXJkU3VpdCwgQm9hcmRDZWxsIH0gZnJvbSAnQC90eXBlcy9nYW1lJztcblxuLy8gR2VuZXJhdGUgYSByYW5kb20gNi1jaGFyYWN0ZXIgcm9vbSBjb2RlXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVSb29tQ29kZSgpOiBzdHJpbmcge1xuICBjb25zdCBjaGFyYWN0ZXJzID0gJ0FCQ0RFRkdISktMTU5QUVJTVFVWV1hZWjIzNDU2Nzg5JzsgLy8gUmVtb3ZlZCBzaW1pbGFyIGxvb2tpbmcgY2hhcmFjdGVyc1xuICBsZXQgcmVzdWx0ID0gJyc7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7XG4gICAgcmVzdWx0ICs9IGNoYXJhY3RlcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJhY3RlcnMubGVuZ3RoKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gQ3JlYXRlIGEgZGVjayBvZiBjYXJkc1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlY2soKTogQ2FyZFtdIHtcbiAgY29uc3Qgc3VpdHM6IENhcmRTdWl0W10gPSBbJ2hlYXJ0cycsICdkaWFtb25kcycsICdjbHVicycsICdzcGFkZXMnXTtcbiAgY29uc3QgcmFua3M6IENhcmRSYW5rW10gPSBbJ0EnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJzEwJywgJ0onLCAnUScsICdLJ107XG4gIGNvbnN0IGRlY2s6IENhcmRbXSA9IFtdO1xuICBcbiAgLy8gQ3JlYXRlIHR3byBkZWNrcyAoMTA0IGNhcmRzKVxuICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgIGZvciAoY29uc3Qgc3VpdCBvZiBzdWl0cykge1xuICAgICAgZm9yIChjb25zdCByYW5rIG9mIHJhbmtzKSB7XG4gICAgICAgIGNvbnN0IGNhcmQ6IENhcmQgPSB7XG4gICAgICAgICAgc3VpdCxcbiAgICAgICAgICByYW5rLFxuICAgICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcmsgSmFja3NcbiAgICAgICAgaWYgKHJhbmsgPT09ICdKJykge1xuICAgICAgICAgIGNhcmQuaXNKYWNrID0gdHJ1ZTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBPbmUtZXllZCBKYWNrczogSmFjayBvZiBIZWFydHMgYW5kIEphY2sgb2YgU3BhZGVzXG4gICAgICAgICAgaWYgKHN1aXQgPT09ICdoZWFydHMnIHx8IHN1aXQgPT09ICdzcGFkZXMnKSB7XG4gICAgICAgICAgICBjYXJkLmphY2tUeXBlID0gJ29uZS1leWVkJztcbiAgICAgICAgICB9IFxuICAgICAgICAgIC8vIFR3by1leWVkIEphY2tzOiBKYWNrIG9mIERpYW1vbmRzIGFuZCBKYWNrIG9mIENsdWJzXG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjYXJkLmphY2tUeXBlID0gJ3R3by1leWVkJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGRlY2sucHVzaChjYXJkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBkZWNrO1xufVxuXG4vLyBTaHVmZmxlIGEgZGVjayBvZiBjYXJkc1xuZXhwb3J0IGZ1bmN0aW9uIHNodWZmbGVEZWNrKGRlY2s6IENhcmRbXSk6IENhcmRbXSB7XG4gIGNvbnN0IHNodWZmbGVkID0gWy4uLmRlY2tdO1xuICBmb3IgKGxldCBpID0gc2h1ZmZsZWQubGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkge1xuICAgIGNvbnN0IGogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoaSArIDEpKTtcbiAgICBbc2h1ZmZsZWRbaV0sIHNodWZmbGVkW2pdXSA9IFtzaHVmZmxlZFtqXSwgc2h1ZmZsZWRbaV1dO1xuICB9XG4gIHJldHVybiBzaHVmZmxlZDtcbn1cblxuLy8gRGVhbCBjYXJkcyB0byBwbGF5ZXJzXG5leHBvcnQgZnVuY3Rpb24gZGVhbENhcmRzKGRlY2s6IENhcmRbXSwgbnVtUGxheWVyczogbnVtYmVyKTogeyBoYW5kczogQ2FyZFtdW10sIHJlbWFpbmluZ0RlY2s6IENhcmRbXSB9IHtcbiAgY29uc3QgaGFuZHM6IENhcmRbXVtdID0gW107XG4gIGNvbnN0IGNhcmRzUGVyUGxheWVyID0gNzsgLy8gRm9yIGEgMi1wbGF5ZXIgZ2FtZVxuICBcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1QbGF5ZXJzOyBpKyspIHtcbiAgICBoYW5kcy5wdXNoKFtdKTtcbiAgfVxuICBcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYXJkc1BlclBsYXllcjsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1QbGF5ZXJzOyBqKyspIHtcbiAgICAgIGlmIChkZWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IGRlY2sucG9wKCkhO1xuICAgICAgICBoYW5kc1tqXS5wdXNoKGNhcmQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHsgaGFuZHMsIHJlbWFpbmluZ0RlY2s6IGRlY2sgfTtcbn1cblxuLy8gQ3JlYXRlIHRoZSBpbml0aWFsIGdhbWUgYm9hcmRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHYW1lQm9hcmQoKTogQm9hcmRDZWxsW11bXSB7XG4gIGNvbnN0IGJvYXJkOiBCb2FyZENlbGxbXVtdID0gW107XG4gIGNvbnN0IHNpemUgPSAxMDsgLy8gMTB4MTAgYm9hcmRcbiAgXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgYm9hcmQucHVzaChbXSk7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaXplOyBqKyspIHtcbiAgICAgIGNvbnN0IGNlbGw6IEJvYXJkQ2VsbCA9IHt9O1xuICAgICAgXG4gICAgICAvLyBNYXJrIGNvcm5lciBjZWxscyBhcyBmcmVlIHNwYWNlc1xuICAgICAgaWYgKFxuICAgICAgICAoaSA9PT0gMCAmJiBqID09PSAwKSB8fFxuICAgICAgICAoaSA9PT0gMCAmJiBqID09PSBzaXplIC0gMSkgfHxcbiAgICAgICAgKGkgPT09IHNpemUgLSAxICYmIGogPT09IDApIHx8XG4gICAgICAgIChpID09PSBzaXplIC0gMSAmJiBqID09PSBzaXplIC0gMSlcbiAgICAgICkge1xuICAgICAgICBjZWxsLmlzQ29ybmVyID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgYm9hcmRbaV0ucHVzaChjZWxsKTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBib2FyZDtcbn1cblxuLy8gQ2hlY2sgaWYgYSBzZXF1ZW5jZSBpcyBmb3JtZWRcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0ZvclNlcXVlbmNlKFxuICBib2FyZDogQm9hcmRDZWxsW11bXSxcbiAgcm93OiBudW1iZXIsXG4gIGNvbDogbnVtYmVyLFxuICBwbGF5ZXI6ICdwbGF5ZXIxJyB8ICdwbGF5ZXIyJ1xuKTogeyBoYXNTZXF1ZW5jZTogYm9vbGVhbjsgc2VxdWVuY2U/OiB7IHN0YXJ0Um93OiBudW1iZXI7IHN0YXJ0Q29sOiBudW1iZXI7IGVuZFJvdzogbnVtYmVyOyBlbmRDb2w6IG51bWJlciB9IH0ge1xuICBjb25zdCBkaXJlY3Rpb25zID0gW1xuICAgIFswLCAxXSwgICAvLyBob3Jpem9udGFsXG4gICAgWzEsIDBdLCAgIC8vIHZlcnRpY2FsXG4gICAgWzEsIDFdLCAgIC8vIGRpYWdvbmFsIGRvd24tcmlnaHRcbiAgICBbMSwgLTFdLCAgLy8gZGlhZ29uYWwgZG93bi1sZWZ0XG4gIF07XG4gIFxuICBmb3IgKGNvbnN0IFtkeCwgZHldIG9mIGRpcmVjdGlvbnMpIHtcbiAgICBsZXQgY291bnQgPSAxO1xuICAgIGxldCBzdGFydFJvdyA9IHJvdztcbiAgICBsZXQgc3RhcnRDb2wgPSBjb2w7XG4gICAgbGV0IGVuZFJvdyA9IHJvdztcbiAgICBsZXQgZW5kQ29sID0gY29sO1xuICAgIFxuICAgIC8vIENoZWNrIGluIHBvc2l0aXZlIGRpcmVjdGlvblxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgNTsgaSsrKSB7XG4gICAgICBjb25zdCBuZXdSb3cgPSByb3cgKyBpICogZHg7XG4gICAgICBjb25zdCBuZXdDb2wgPSBjb2wgKyBpICogZHk7XG4gICAgICBcbiAgICAgIGlmIChcbiAgICAgICAgbmV3Um93IDwgMCB8fCBuZXdSb3cgPj0gYm9hcmQubGVuZ3RoIHx8XG4gICAgICAgIG5ld0NvbCA8IDAgfHwgbmV3Q29sID49IGJvYXJkWzBdLmxlbmd0aCB8fFxuICAgICAgICBib2FyZFtuZXdSb3ddW25ld0NvbF0uY2hpcCAhPT0gcGxheWVyXG4gICAgICApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvdW50Kys7XG4gICAgICBlbmRSb3cgPSBuZXdSb3c7XG4gICAgICBlbmRDb2wgPSBuZXdDb2w7XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGluIG5lZ2F0aXZlIGRpcmVjdGlvblxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgNTsgaSsrKSB7XG4gICAgICBjb25zdCBuZXdSb3cgPSByb3cgLSBpICogZHg7XG4gICAgICBjb25zdCBuZXdDb2wgPSBjb2wgLSBpICogZHk7XG4gICAgICBcbiAgICAgIGlmIChcbiAgICAgICAgbmV3Um93IDwgMCB8fCBuZXdSb3cgPj0gYm9hcmQubGVuZ3RoIHx8XG4gICAgICAgIG5ld0NvbCA8IDAgfHwgbmV3Q29sID49IGJvYXJkWzBdLmxlbmd0aCB8fFxuICAgICAgICBib2FyZFtuZXdSb3ddW25ld0NvbF0uY2hpcCAhPT0gcGxheWVyXG4gICAgICApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvdW50Kys7XG4gICAgICBzdGFydFJvdyA9IG5ld1JvdztcbiAgICAgIHN0YXJ0Q29sID0gbmV3Q29sO1xuICAgIH1cbiAgICBcbiAgICBpZiAoY291bnQgPj0gNSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaGFzU2VxdWVuY2U6IHRydWUsXG4gICAgICAgIHNlcXVlbmNlOiB7XG4gICAgICAgICAgc3RhcnRSb3csXG4gICAgICAgICAgc3RhcnRDb2wsXG4gICAgICAgICAgZW5kUm93LFxuICAgICAgICAgIGVuZENvbCxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4geyBoYXNTZXF1ZW5jZTogZmFsc2UgfTtcbn1cbiJdLCJuYW1lcyI6WyJ2NCIsInV1aWR2NCIsImdlbmVyYXRlUm9vbUNvZGUiLCJjaGFyYWN0ZXJzIiwicmVzdWx0IiwiaSIsImNoYXJBdCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImxlbmd0aCIsImNyZWF0ZURlY2siLCJzdWl0cyIsInJhbmtzIiwiZGVjayIsInN1aXQiLCJyYW5rIiwiY2FyZCIsImlkIiwiaXNKYWNrIiwiamFja1R5cGUiLCJwdXNoIiwic2h1ZmZsZURlY2siLCJzaHVmZmxlZCIsImoiLCJkZWFsQ2FyZHMiLCJudW1QbGF5ZXJzIiwiaGFuZHMiLCJjYXJkc1BlclBsYXllciIsInBvcCIsInJlbWFpbmluZ0RlY2siLCJjcmVhdGVHYW1lQm9hcmQiLCJib2FyZCIsInNpemUiLCJjZWxsIiwiaXNDb3JuZXIiLCJjaGVja0ZvclNlcXVlbmNlIiwicm93IiwiY29sIiwicGxheWVyIiwiZGlyZWN0aW9ucyIsImR4IiwiZHkiLCJjb3VudCIsInN0YXJ0Um93Iiwic3RhcnRDb2wiLCJlbmRSb3ciLCJlbmRDb2wiLCJuZXdSb3ciLCJuZXdDb2wiLCJjaGlwIiwiaGFzU2VxdWVuY2UiLCJzZXF1ZW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/game.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ws","vendor-chunks/socket.io-parser","vendor-chunks/engine.io-parser","vendor-chunks/@socket.io","vendor-chunks/ms","vendor-chunks/supports-color","vendor-chunks/has-flag","vendor-chunks/engine.io","vendor-chunks/socket.io","vendor-chunks/socket.io-adapter","vendor-chunks/uuid","vendor-chunks/negotiator","vendor-chunks/mime-db","vendor-chunks/vary","vendor-chunks/object-assign","vendor-chunks/mime-types","vendor-chunks/cors","vendor-chunks/cookie","vendor-chunks/base64id","vendor-chunks/accepts"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsocket%2Froute&page=%2Fapi%2Fsocket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsocket%2Froute.ts&appDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaswatraj%2FDesktop%2Fopen-source%2Fsequence&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();